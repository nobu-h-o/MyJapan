/**
 * turn.js 3rd release
 * www.turnjs.com
 *
 * Copyright (C) 2012, Emmanuel Garcia.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *
 * 2. Any redistribution, use, or modification is done solely for personal 
 * benefit and not for any commercial purpose or for monetary gain.
 * 
 * This is a compressed version of the above file.
 **/
'use strict';(function(l){var O,J="",P=Math.PI,K=P/2,L="ontouchstart"in window,T=L?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},U={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br"]},ca=["single","double"],da={page:1,gradients:!0,duration:600,acceleration:!0,display:"double",when:null},ea={folding:null,corners:"forward",cornerSize:100,gradients:!0,duration:600,acceleration:!0},W={0:{top:0,left:0,right:"auto",bottom:"auto"},
1:{top:0,right:0,left:"auto",bottom:"auto"}},G=function(a,b,c,d){return{css:{position:"absolute",top:a,left:b,overflow:d||"hidden","z-index":c||"auto"}}},X=function(a,b,c,d,e){var f=1-e,h=f*f*f,g=e*e*e;return q(Math.round(h*a.x+3*e*f*f*b.x+3*e*e*f*c.x+g*d.x),Math.round(h*a.y+3*e*f*f*b.y+3*e*e*f*c.y+g*d.y))},q=function(a,b){return{x:a,y:b}},z=function(a,b,c){return O&&c?" translate3d("+a+"px,"+b+"px, 0px) ":" translate("+a+"px, "+b+"px) "},A=function(a){return" rotate("+a+"deg) "},D=function(a,b){return Object.prototype.hasOwnProperty.call(b,
a)},fa=function(){for(var a=["Moz","Webkit","Khtml","O","ms"],b=a.length,c="";b--;)a[b]+"Transform"in document.body.style&&(c="-"+a[b].toLowerCase()+"-");return c},Y=function(a,b,c,d,e){var f,h=[];if(J=="-webkit-"){for(f=0;f<e;f++)h.push("color-stop("+d[f][0]+", "+d[f][1]+")");a.css({"background-image":"-webkit-gradient(linear, "+b.x+"% "+b.y+"%,  "+c.x+"% "+c.y+"%, "+h.join(",")+" )"})}else{b={x:b.x/100*a.width(),y:b.y/100*a.height()};c={x:c.x/100*a.width(),y:c.y/100*a.height()};var g=c.x-b.x;f=
c.y-b.y;var r=Math.atan2(f,g),u=r-Math.PI/2;u=Math.abs(a.width()*Math.sin(u))+Math.abs(a.height()*Math.cos(u));g=Math.sqrt(f*f+g*g);c=q(c.x<b.x?a.width():0,c.y<b.y?a.height():0);var n=Math.tan(r);f=-1/n;n=(f*c.x-c.y-n*b.x+b.y)/(f-n);b=Math.sqrt(Math.pow(n-b.x,2)+Math.pow(f*n-f*c.x+c.y-b.y,2));for(f=0;f<e;f++)h.push(" "+d[f][1]+" "+(b+g*d[f][0])*100/u+"%");a.css({"background-image":J+"linear-gradient("+-r+"rad,"+h.join(",")+")"})}},m={init:function(a){O===void 0&&(O="WebKitCSSMatrix"in window||"MozPerspective"in
document.body.style,J=fa());var b,c=this.data(),d=this.children();a=l.extend({width:this.width(),height:this.height()},da,a);c.opts=a;c.pageObjs={};c.pages={};c.pageWrap={};c.pagePlace={};c.pageMv=[];c.totalPages=a.pages||0;if(a.when)for(b in a.when)D(b,a.when)&&this.bind(b,a.when[b]);this.css({position:"relative",width:a.width,height:a.height});this.turn("display",a.display);O&&!L&&a.acceleration&&this.transform(z(0,0,!0));for(b=0;b<d.length;b++)this.turn("addPage",d[b],b+1);this.turn("page",a.page);
U=l.extend({},U,a.corners);l(this).bind(T.start,function(e){for(var f in c.pages)if(D(f,c.pages)&&k._eventStart.call(c.pages[f],e)===!1)return!1});l(document).bind(T.move,function(e){for(var f in c.pages)D(f,c.pages)&&k._eventMove.call(c.pages[f],e)}).bind(T.end,function(e){for(var f in c.pages)D(f,c.pages)&&k._eventEnd.call(c.pages[f],e)});c.done=!0;return this},addPage:function(a,b){var c=!1,d=this.data(),e=d.totalPages+1;if(b)if(b==e)b=e,c=!0;else{if(b>e)throw Error('It is impossible to add the page "'+
b+'", the maximum value is: "'+e+'"');}else b=e,c=!0;b>=1&&b<=e&&(d.done&&this.turn("stop"),b in d.pageObjs&&m._movePages.call(this,b,1),c&&(d.totalPages=e),d.pageObjs[b]=l(a).addClass("turn-page p"+b),m._addPage.call(this,b),d.done&&this.turn("update"),m._removeFromDOM.call(this));return this},_addPage:function(a){var b=this.data(),c=b.pageObjs[a];if(c)if(m._necessPage.call(this,a)){if(!b.pageWrap[a]){var d=b.display=="double"?this.width()/2:this.width(),e=this.height();c.css({width:d,height:e});
b.pagePlace[a]=a;b.pageWrap[a]=l("<div/>",{"class":"turn-page-wrapper",page:a,css:{position:"absolute",overflow:"hidden",width:d,height:e}}).css(W[b.display=="double"?a%2:0]);this.append(b.pageWrap[a]);b.pageWrap[a].prepend(b.pageObjs[a])}a&&m._setPageLoc.call(this,a)!=1||m._makeFlip.call(this,a)}else b.pagePlace[a]=0,b.pageObjs[a]&&b.pageObjs[a].remove()},hasPage:function(a){return a in this.data().pageObjs},_makeFlip:function(a){var b=this.data();if(!b.pages[a]&&b.pagePlace[a]==a){var c=b.display==
"single",d=a%2;b.pages[a]=b.pageObjs[a].css({width:c?this.width():this.width()/2,height:this.height()}).flip({page:a,next:c&&a===b.totalPages?a-1:d||c?a+1:a-1,turn:this,duration:b.opts.duration,acceleration:b.opts.acceleration,corners:c?"all":d?"forward":"backward",backGradient:b.opts.gradients,frontGradient:b.opts.gradients}).flip("disable",b.disabled).bind("pressed",m._pressed).bind("released",m._released).bind("start",m._start).bind("end",m._end).bind("flip",m._flip)}return b.pages[a]},_makeRange:function(){var a;
this.data();var b=this.turn("range");for(a=b[0];a<=b[1];a++)m._addPage.call(this,a)},range:function(a){var b=this.data();a=a||b.tpage||b.page;var c=m._view.call(this,a);if(a<1||a>b.totalPages)throw Error('"'+a+'" is not a page for range');c[1]=c[1]||c[0];if(c[0]>=1&&c[1]<=b.totalPages)if(b.totalPages-c[1]>c[0]){a=Math.min(c[0]-1,2);var d=4-a}else d=Math.min(b.totalPages-c[1],2),a=4-d;else d=a=5;return[Math.max(1,c[0]-a),Math.min(b.totalPages,c[1]+d)]},_necessPage:function(a){if(a===0)return!0;var b=
this.turn("range");return a>=b[0]&&a<=b[1]},_removeFromDOM:function(){var a,b=this.data();for(a in b.pageWrap)D(a,b.pageWrap)&&!m._necessPage.call(this,a)&&m._removePageFromDOM.call(this,a)},_removePageFromDOM:function(a){var b=this.data();if(b.pages[a]){var c=b.pages[a].data();c.f&&c.f.fwrapper&&c.f.fwrapper.remove();b.pages[a].remove();delete b.pages[a]}b.pageObjs[a]&&b.pageObjs[a].remove();b.pageWrap[a]&&(b.pageWrap[a].remove(),delete b.pageWrap[a]);delete b.pagePlace[a]},removePage:function(a){var b=
this.data();b.pageObjs[a]&&(this.turn("stop"),m._removePageFromDOM.call(this,a),delete b.pageObjs[a],m._movePages.call(this,a,-1),--b.totalPages,m._makeRange.call(this),b.page>b.totalPages&&this.turn("page",b.totalPages));return this},_movePages:function(a,b){var c,d=this.data(),e=d.display=="single",f=function(h){var g=h+b,r=g%2;d.pageObjs[h]&&(d.pageObjs[g]=d.pageObjs[h].removeClass("page"+h).addClass("page"+g));d.pagePlace[h]&&d.pageWrap[h]&&(d.pagePlace[g]=g,d.pageWrap[g]=d.pageWrap[h].css(W[e?
0:r]).attr("page",g),d.pages[h]&&(d.pages[g]=d.pages[h].flip("options",{page:g,next:e||r?g+1:g-1,corners:e?"all":r?"forward":"backward"})),b&&(delete d.pages[h],delete d.pagePlace[h],delete d.pageObjs[h],delete d.pageWrap[h],delete d.pageObjs[h]))};if(b>0)for(c=d.totalPages;c>=a;c--)f(c);else for(c=a;c<=d.totalPages;c++)f(c)},display:function(a){var b=this.data(),c=b.display;if(a){if(l.inArray(a,ca)==-1)throw Error('"'+a+'" is not a value for display');a=="single"?b.pageObjs[0]||(this.turn("stop").css({overflow:"hidden"}),
b.pageObjs[0]=l("<div />",{"class":"turn-page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)):b.pageObjs[0]&&(this.turn("stop").css({overflow:""}),b.pageObjs[0].remove(),delete b.pageObjs[0]);b.display=a;c&&(a=this.turn("size"),m._movePages.call(this,1,0),this.turn("size",a.width,a.height).turn("update"));return this}return c},animating:function(){return this.data().pageMv.length>0},disable:function(a){var b,c=this.data(),d=this.turn("view");c.disabled=a===void 0||a===
!0;for(b in c.pages)D(b,c.pages)&&c.pages[b].flip("disable",a?l.inArray(b,d):!1);return this},size:function(a,b){if(a&&b){var c=this.data(),d=c.display=="double"?a/2:a,e;this.css({width:a,height:b});c.pageObjs[0]&&c.pageObjs[0].css({width:d,height:b});for(e in c.pageWrap)D(e,c.pageWrap)&&(c.pageObjs[e].css({width:d,height:b}),c.pageWrap[e].css({width:d,height:b}),c.pages[e]&&c.pages[e].css({width:d,height:b}));this.turn("resize");return this}return{width:this.width(),height:this.height()}},resize:function(){var a,
b=this.data();b.pages[0]&&(b.pageWrap[0].css({left:-this.width()}),b.pages[0].flip("resize",!0));for(a=1;a<=b.totalPages;a++)b.pages[a]&&b.pages[a].flip("resize",!0)},_removeMv:function(a){var b,c=this.data();for(b=0;b<c.pageMv.length;b++)if(c.pageMv[b]==a)return c.pageMv.splice(b,1),!0;return!1},_addMv:function(a){var b=this.data();m._removeMv.call(this,a);b.pageMv.push(a)},_view:function(a){var b=this.data();a=a||b.page;return b.display=="double"?a%2?[a-1,a]:[a,a+1]:[a]},view:function(a){var b=
this.data();a=m._view.call(this,a);return b.display=="double"?[a[0]>0?a[0]:0,a[1]<=b.totalPages?a[1]:0]:[a[0]>0&&a[0]<=b.totalPages?a[0]:0]},stop:function(a){var b,c=this.data(),d=c.pageMv;c.pageMv=[];c.tpage&&(c.page=c.tpage,delete c.tpage);for(b in d)D(b,d)&&(a=c.pages[d[b]].data().f.opts,k._moveFoldingPage.call(c.pages[d[b]],null),c.pages[d[b]].flip("hideFoldedPage"),c.pagePlace[a.next]=a.next,a.force&&(a.next=a.page%2===0?a.page-1:a.page+1,delete a.force));this.turn("update");return this},pages:function(a){var b=
this.data();if(a){if(a<b.totalPages){for(var c=a+1;c<=b.totalPages;c++)this.turn("removePage",c);this.turn("page")>a&&this.turn("page",a)}b.totalPages=a;return this}return b.totalPages},_fitPage:function(a,b){var c=this.data(),d=this.turn("view",a);c.page!=a&&(this.trigger("turning",[a,d]),l.inArray(1,d)!=-1&&this.trigger("first"),l.inArray(c.totalPages,d)!=-1&&this.trigger("last"));c.pageObjs[a]&&(c.tpage=a,this.turn("stop",b),m._removeFromDOM.call(this),m._makeRange.call(this),this.trigger("turned",
[a,d]))},_turnPage:function(a){var b=this.data(),c=this.turn("view"),d=this.turn("view",a);b.page!=a&&(this.trigger("turning",[a,d]),l.inArray(1,d)!=-1&&this.trigger("first"),l.inArray(b.totalPages,d)!=-1&&this.trigger("last"));if(b.pageObjs[a]){b.tpage=a;this.turn("stop");m._makeRange.call(this);if(b.display=="single"){var e=c[0];var f=d[0]}else c[1]&&a>c[1]?(e=c[1],f=d[0]):c[0]&&a<c[0]&&(e=c[0],f=d[1]);b.pages[e]&&(a=b.pages[e].data().f.opts,b.tpage=f,a.next!=f&&(a.next=f,b.pagePlace[f]=a.page,
a.force=!0),b.display=="single"?b.pages[e].flip("turnPage",d[0]>c[0]?"br":"bl"):b.pages[e].flip("turnPage"))}},page:function(a){a=parseInt(a,10);var b=this.data();return a>0&&a<=b.totalPages?(b.done&&l.inArray(a,this.turn("view"))==-1?m._turnPage.call(this,a):m._fitPage.call(this,a),this):b.page},next:function(){var a=this.data();return this.turn("page",m._view.call(this,a.page).pop()+1)},previous:function(){var a=this.data();return this.turn("page",m._view.call(this,a.page).shift()-1)},_addMotionPage:function(){var a=
l(this).data().f.opts,b=a.turn,c=b.data();a.pageMv=a.page;m._addMv.call(b,a.pageMv);c.pagePlace[a.next]=a.page;b.turn("update")},_start:function(a,b,c){var d=b.turn.data(),e=l.Event("start");a.stopPropagation();b.turn.trigger(e,[b,c]);e.isDefaultPrevented()?a.preventDefault():(d.display=="single"&&(c=c.charAt(1)=="l",b.page==1&&c||b.page==d.totalPages&&!c?a.preventDefault():c?(b.next=b.next<b.page?b.next:b.page-1,b.force=!0):b.next=b.next>b.page?b.next:b.page+1),m._addMotionPage.call(this))},_end:function(a,
b){var c=l(this).data().f.opts,d=c.turn,e=d.data();a.stopPropagation();if(b||e.tpage){if(e.tpage==c.next||e.tpage==c.page)delete e.tpage,m._fitPage.call(d,e.tpage||c.next,!0)}else m._removeMv.call(d,c.pageMv),d.turn("update")},_pressed:function(){var a,b=l(this).data().f,c=b.opts.turn.data().pages;for(a in c)a!=b.opts.page&&c[a].flip("disable",!0);return b.time=(new Date).getTime()},_released:function(a,b){var c=l(this),d=c.data().f;a.stopPropagation();if((new Date).getTime()-d.time<200||b.x<0||b.x>
l(this).width())a.preventDefault(),d.opts.turn.data().tpage=d.opts.next,d.opts.turn.turn("update"),l(c).flip("turnPage")},_flip:function(){var a=l(this).data().f.opts;a.turn.trigger("turn",[a.next])},calculateZ:function(a){var b=this,c=this.data();var d=this.turn("view");var e=d[0]||d[1],f={pageZ:{},partZ:{},pageV:{}},h=function(n){n=b.turn("view",n);n[0]&&(f.pageV[n[0]]=!0);n[1]&&(f.pageV[n[1]]=!0)};for(d=0;d<a.length;d++){var g=a[d];var r=c.pages[g].data().f.opts.next;var u=c.pagePlace[g];h(g);
h(r);g=c.pagePlace[r]==r?r:g;f.pageZ[g]=c.totalPages-Math.abs(e-g);f.partZ[u]=c.totalPages*2+Math.abs(e-g)}return f},update:function(){var a,b=this.data();if(b.pageMv.length&&b.pageMv[0]!==0){var c=this.turn("calculateZ",b.pageMv);this.turn("view",b.tpage);for(a in b.pageWrap)D(a,b.pageWrap)&&(b.pageWrap[a].css({display:c.pageV[a]?"":"none","z-index":c.pageZ[a]||0}),b.pages[a]&&(b.pages[a].flip("z",c.partZ[a]||null),c.pageV[a]&&b.pages[a].flip("resize"),b.tpage&&b.pages[a].flip("disable",!0)))}else for(a in b.pageWrap)D(a,
b.pageWrap)&&(c=m._setPageLoc.call(this,a),b.pages[a]&&b.pages[a].flip("disable",b.disabled||c!=1).flip("z",null))},_setPageLoc:function(a){var b=this.data(),c=this.turn("view");if(a==c[0]||a==c[1])return b.pageWrap[a].css({"z-index":b.totalPages,display:""}),1;if(b.display=="single"&&a==c[0]+1||b.display=="double"&&a==c[0]-2||a==c[1]+2)return b.pageWrap[a].css({"z-index":b.totalPages-1,display:""}),2;b.pageWrap[a].css({"z-index":0,display:"none"});return 0}},k={init:function(a){a.gradients&&(a.frontGradient=
!0,a.backGradient=!0);this.data({f:{}});this.flip("options",a);k._addPageWrapper.call(this);return this},setData:function(a){var b=this.data();b.f=l.extend(b.f,a);return this},options:function(a){var b=this.data().f;return a?(k.setData.call(this,{opts:l.extend({},b.opts||ea,a)}),this):b.opts},z:function(a){var b=this.data().f;b.opts["z-index"]=a;b.fwrapper.css({"z-index":a||parseInt(b.parent.css("z-index"),10)||0});return this},_cAllowed:function(){return U[this.data().f.opts.corners]||this.data().f.opts.corners},
_cornerActivated:function(a){if(a.originalEvent===void 0)return!1;a=L?a.originalEvent.touches:[a];var b=this.data().f,c=b.parent.offset(),d=this.width(),e=this.height();a={x:Math.max(0,a[0].pageX-c.left),y:Math.max(0,a[0].pageY-c.top)};b=b.opts.cornerSize;c=k._cAllowed.call(this);if(a.x<=0||a.y<=0||a.x>=d||a.y>=e)return!1;if(a.y<b)a.corner="t";else if(a.y>=e-b)a.corner="b";else return!1;if(a.x<=b)a.corner+="l";else if(a.x>=d-b)a.corner+="r";else return!1;return l.inArray(a.corner,c)==-1?!1:a},_c:function(a,
b){b=b||0;return{tl:q(b,b),tr:q(this.width()-b,b),bl:q(b,this.height()-b),br:q(this.width()-b,this.height()-b)}[a]},_c2:function(a){return{tl:q(this.width()*2,0),tr:q(-this.width(),0),bl:q(this.width()*2,this.height()),br:q(-this.width(),this.height())}[a]},_foldingPage:function(a){a=this.data().f.opts;if(a.folding)return a.folding;if(a.turn){var b=a.turn.data();return b.display=="single"?b.pageObjs[a.next]?b.pageObjs[0]:null:b.pageObjs[a.next]}},_backGradient:function(){var a=this.data().f,b=a.opts.turn;
(b=a.opts.backGradient&&(!b||b.data().display=="single"||a.opts.page!=2&&a.opts.page!=b.data().totalPages-1))&&!a.bshadow&&(a.bshadow=l("<div/>",G(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(a.parent));return b},resize:function(a){var b=this.data().f,c=this.width(),d=this.height(),e=Math.round(Math.sqrt(Math.pow(c,2)+Math.pow(d,2)));a&&(b.wrapper.css({width:e,height:e}),b.fwrapper.css({width:e,height:e}).children(":first-child").css({width:c,height:d}),b.fpage.css({width:d,
height:c}),b.opts.frontGradient&&b.ashadow.css({width:d,height:c}),k._backGradient.call(this)&&b.bshadow.css({width:c,height:d}));b.parent.is(":visible")&&(b.fwrapper.css({top:b.parent.offset().top,left:b.parent.offset().left}),b.opts.turn&&b.fparent.css({top:-b.opts.turn.offset().top,left:-b.opts.turn.offset().left}));this.flip("z",b.opts["z-index"])},_addPageWrapper:function(){var a=this.data().f,b=this.parent();if(!a.wrapper){this.css("left");this.css("top");this.width();this.height();a.parent=
b;a.fparent=a.opts.turn?a.opts.turn.data().fparent:l("#turn-fwrappers");if(!a.fparent){var c=l("<div/>",{css:{"pointer-events":"none"}}).hide();c.data().flips=0;a.opts.turn?(c.css(G(-a.opts.turn.offset().top,-a.opts.turn.offset().left,"auto","visible").css).appendTo(a.opts.turn),a.opts.turn.data().fparent=c):c.css(G(0,0,"auto","visible").css).attr("id","turn-fwrappers").appendTo(l("body"));a.fparent=c}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"});a.wrapper=l("<div/>",G(0,
0,this.css("z-index"))).appendTo(b).prepend(this);a.fwrapper=l("<div/>",G(b.offset().top,b.offset().left)).hide().appendTo(a.fparent);a.fpage=l("<div/>",{css:{cursor:"default"}}).appendTo(l("<div/>",G(0,0,0,"visible")).appendTo(a.fwrapper));a.opts.frontGradient&&(a.ashadow=l("<div/>",G(0,0,1)).appendTo(a.fpage));k.setData.call(this,a);k.resize.call(this,!0)}},_fold:function(a){var b=this,c=0,d=0,e,f,h,g,r,u,n=q(0,0),M=q(0,0),t=q(0,0),x=this.width(),B=this.height(),Q=k._foldingPage.call(this),y=this.data().f,
C=y.opts.acceleration,V=y.wrapper.height(),R=k._c.call(this,a.corner),H=a.corner.substr(0,1)=="t",F=a.corner.substr(1,1)=="l",N=function(){var p=q(R.x?R.x-a.x:a.x,R.y?R.y-a.y:a.y),w=Math.atan2(p.y,p.x);d=K-w;c=d/P*180;var v=q(F?x-p.x/2:a.x+p.x/2,p.y/2);var E=Math.max(0,Math.sin(d-Math.atan2(v.y,v.x))*Math.sqrt(Math.pow(v.x,2)+Math.pow(v.y,2)));t=q(E*Math.sin(d),E*Math.cos(d));if(d>K&&(t.x+=Math.abs(t.y*Math.tan(w)),t.y=0,Math.round(t.x*Math.tan(P-d))<B))return a.y=Math.sqrt(Math.pow(B,2)+2*v.x*p.x),
H&&(a.y=B-a.y),N();d>K&&(p=P-d,w=V-B/Math.sin(p),n=q(Math.round(w*Math.cos(p)),Math.round(w*Math.sin(p))),F&&(n.x=-n.x),H&&(n.y=-n.y));e=Math.round(t.y/Math.tan(d)+t.x);p=x-e;w=p*Math.cos(d*2);v=p*Math.sin(d*2);M=q(Math.round(F?p-w:e+w),Math.round(H?v:B-v));r=p*Math.sin(d);p=k._c2.call(b,a.corner);p=Math.sqrt(Math.pow(p.x-a.x,2)+Math.pow(p.y-a.y,2));u=p<x?p/x:1;y.opts.frontGradient&&(g=r>100?(r-100)/r:0,f=q(r*Math.sin(K-d)/B*100,r*Math.cos(K-d)/x*100),H&&(f.y=100-f.y),F&&(f.x=100-f.x));k._backGradient.call(b)&&
(h=q(r*Math.sin(d)/x*100,r*Math.cos(d)/B*100),F||(h.x=100-h.x),H||(h.y=100-h.y));t.x=Math.round(t.x);t.y=Math.round(t.y);return!0},S=function(p,w,v,E){var I=["0","auto"],Z=(x-V)*v[0]/100,aa=(B-V)*v[1]/100;w={left:I[w[0]],top:I[w[1]],right:I[w[2]],bottom:I[w[3]]};I=E!=90&&E!=-90?F?-1:1:0;v=v[0]+"% "+v[1]+"%";b.css(w).transform(A(E)+z(p.x+I,p.y,C),v);y.fpage.parent().css(w);y.wrapper.transform(z(-p.x+Z-I,-p.y+aa,C)+A(-E),v);y.fwrapper.transform(z(-p.x+n.x+Z,-p.y+n.y+aa,C)+A(-E),v);y.fpage.parent().transform(A(E)+
z(p.x+M.x-n.x,p.y+M.y-n.y,C),v);y.opts.frontGradient&&Y(y.ashadow,q(F?100:0,H?100:0),q(f.x,f.y),[[g,"rgba(0,0,0,0)"],[(1-g)*.8+g,"rgba(0,0,0,"+.2*u+")"],[1,"rgba(255,255,255,"+.2*u+")"]],3,d);k._backGradient.call(b)&&Y(y.bshadow,q(F?0:100,H?0:100),q(h.x,h.y),[[.8,"rgba(0,0,0,0)"],[1,"rgba(0,0,0,"+.3*u+")"],[1,"rgba(0,0,0,0)"]],3)};switch(a.corner){case "tl":a.x=Math.max(a.x,1);N();S(t,[1,0,0,1],[100,0],c);y.fpage.transform(z(-B,-x,C)+A(90-c*2),"100% 100%");Q.transform(A(90)+z(0,-B,C),"0% 0%");break;
case "tr":a.x=Math.min(a.x,x-1);N();S(q(-t.x,t.y),[0,0,0,1],[0,0],-c);y.fpage.transform(z(0,-x,C)+A(-90+c*2),"0% 100%");Q.transform(A(270)+z(-x,0,C),"0% 0%");break;case "bl":a.x=Math.max(a.x,1);N();S(q(t.x,-t.y),[1,1,0,0],[100,100],-c);y.fpage.transform(z(-B,0,C)+A(-90+c*2),"100% 0%");Q.transform(A(270)+z(-x,0,C),"0% 0%");break;case "br":a.x=Math.min(a.x,x-1),N(),S(q(-t.x,-t.y),[0,1,1,0],[0,100],c),y.fpage.transform(A(90-c*2),"0% 0%"),Q.transform(A(90)+z(0,-B,C),"0% 0%")}y.point=a},_moveFoldingPage:function(a){var b=
this.data().f,c=k._foldingPage.call(this);c&&(a?b.fpage.children()[b.ashadow?"1":"0"]||(k.setData.call(this,{backParent:c.parent()}),b.fpage.prepend(c)):b.backParent&&b.backParent.prepend(c))},_showFoldedPage:function(a,b){var c=k._foldingPage.call(this),d=this.data(),e=d.f;if(!e.point||e.point.corner!=a.corner){var f=l.Event("start");this.trigger(f,[e.opts,a.corner]);if(f.isDefaultPrevented())return!1}if(c){if(b){var h=this;b=e.point&&e.point.corner==a.corner?e.point:k._c.call(this,a.corner,1);this.animatef({from:[b.x,
b.y],to:[a.x,a.y],duration:500,frame:function(g){a.x=Math.round(g[0]);a.y=Math.round(g[1]);k._fold.call(h,a)}})}else k._fold.call(this,a),d.effect&&!d.effect.turning&&this.animatef(!1);e.fwrapper.is(":visible")||(e.fparent.show().data().flips++,k._moveFoldingPage.call(this,!0),e.fwrapper.show(),e.bshadow&&e.bshadow.show());return!0}return!1},hide:function(){var a=this.data().f,b=k._foldingPage.call(this);--a.fparent.data().flips===0&&a.fparent.hide();this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform("",
"0% 100%");a.wrapper.transform("","0% 100%");a.fwrapper.hide();a.bshadow&&a.bshadow.hide();b.transform("","0% 0%");return this},hideFoldedPage:function(a){var b=this.data().f;if(b.point){var c=this,d=b.point,e=function(){b.point=null;c.flip("hide");c.trigger("end",[!1])};if(a){var f=k._c.call(this,d.corner);a=d.corner.substr(0,1)=="t"?Math.min(0,d.y-f.y)/2:Math.max(0,d.y-f.y)/2;var h=q(d.x,d.y+a),g=q(f.x,f.y-a);this.animatef({from:0,to:1,frame:function(r){r=X(d,h,g,f,r);d.x=r.x;d.y=r.y;k._fold.call(c,
d)},complete:e,duration:800,hiding:!0})}else this.animatef(!1),e()}},turnPage:function(a){var b=this,c=this.data().f;a={corner:c.corner?c.corner.corner:a||k._cAllowed.call(this)[0]};var d=c.point||k._c.call(this,a.corner,c.opts.turn?c.opts.turn.data().opts.elevation:0),e=k._c2.call(this,a.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(f){f=X(d,d,e,e,f);a.x=f.x;a.y=f.y;k._showFoldedPage.call(b,a)},complete:function(){b.trigger("end",[!0])},duration:c.opts.duration,turning:!0});c.corner=
null},moving:function(){return"effect"in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},_eventStart:function(a){var b=this.data().f;if(!b.disabled&&!this.flip("isTurning")){b.corner=k._cornerActivated.call(this,a);if(b.corner&&k._foldingPage.call(this,b.corner))return k._moveFoldingPage.call(this,!0),this.trigger("pressed",[b.point]),!1;b.corner=null}},_eventMove:function(a){var b=this.data().f;if(!b.disabled)if(a=L?a.originalEvent.touches:[a],b.corner){var c=
b.parent.offset();b.corner.x=a[0].pageX-c.left;b.corner.y=a[0].pageY-c.top;k._showFoldedPage.call(this,b.corner)}else!this.data().effect&&this.is(":visible")&&((a=k._cornerActivated.call(this,a[0]))?(b=k._c.call(this,a.corner,b.opts.cornerSize/2),a.x=b.x,a.y=b.y,k._showFoldedPage.call(this,a,!0)):k.hideFoldedPage.call(this,!0))},_eventEnd:function(){var a=this.data().f;if(!a.disabled&&a.point){var b=l.Event("released");this.trigger(b,[a.point]);b.isDefaultPrevented()||k.hideFoldedPage.call(this,!0)}a.corner=
null},disable:function(a){k.setData.call(this,{disabled:a});return this}},ba=function(a,b,c){if(c[0]&&typeof c[0]!="object"){if(b[c[0]]&&c[0].toString().substr(0,1)!="_")return b[c[0]].apply(a,Array.prototype.slice.call(c,1));throw c[0]+" is an invalid value";}return b.init.apply(a,c)};l.extend(l.fn,{flip:function(a,b){return ba(this,k,arguments)},turn:function(a){return ba(this,m,arguments)},transform:function(a,b){var c={};b&&(c[J+"transform-origin"]=b);c[J+"transform"]=a;return this.css(c)},animatef:function(a){var b=
this.data();b.effect&&clearInterval(b.effect.handle);if(a){a.to.length||(a.to=[a.to]);a.from.length||(a.from=[a.from]);a.easing||(a.easing=function(u,n,M,t,x){return t*Math.sqrt(1-(n=n/x-1)*n)+M});var c,d=[],e=a.to.length,f=this,h=a.fps||30,g=-h,r=function(){var u,n=[];g=Math.min(a.duration,g+h);for(u=0;u<e;u++)n.push(a.easing(1,g,a.from[u],d[u],a.duration));a.frame(e==1?n[0]:n);g==a.duration&&(clearInterval(b.effect.handle),delete b.effect,f.data(b),a.complete&&a.complete())};for(c=0;c<e;c++)d.push(a.to[c]-
a.from[c]);b.effect=a;b.effect.handle=setInterval(r,h);this.data(b);r()}else delete b.effect}});l.isTouch=L})(jQuery);